<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>The Scala.js Tutorial</title>

    <!-- See: https://js.cytoscape.org/ -->
    <script type="text/javascript" src="cytoscape.js"></script>

    <!-- Include Scala.js compiled code -->
    <script type="text/javascript" src="./target/scala-2.12/scalajs-experiments-fastopt.js"></script>

    <script type="text/javascript">
        function render(order, graphs) {
            var g = {
                container: document.getElementById('cy'),
                elements: [],
                layout: {
                    name: 'preset',
                    positions: {}
                },
                style: cytoscape.stylesheet()
                    .selector('node')
                      .style({
                        'width': '6px',
                        'height': '6px',
                        'shape': 'ellipse'
                      })
                    .selector('edge')
                      .style({
                        'width': '1.5px'
                      })
            };

            var cols = Math.ceil(Math.sqrt(graphs.length));

            graphs.forEach( function(graph, idx) {
                function idPrefix(s, i) { return 'g'+idx+s+i; };

                var i;
                for (i = 1; i <= order; i++) {
                  var nodeId = idPrefix('n', i);
                  g.elements.push({ data: { id: nodeId } });

                  var graphSpacing = 50;
                  var graphRadius = 15;
                  var cx = (idx % cols) * graphSpacing;
                  var cy = Math.floor(idx / cols) * graphSpacing;
                  var a = 2*Math.PI*i/order;
                  g.layout.positions[nodeId] = {
                    x: cx+graphRadius*Math.cos(a),
                    y: cy+graphRadius*Math.sin(a)
                  };
                }

                graph.forEach( function(edge, edgeIdx) {
                  g.elements.push({
                      data: {
                        id: idPrefix('e', edgeIdx),
                        source: idPrefix('n', edge[0]),
                        target: idPrefix('n', edge[1])
                      } });
                } );

            });
            var cy = cytoscape(g);
            cy.ready( function() { console.log('graph ready') } );
        }
    </script>

    <style>
        #cy {
            position: absolute;
            width: 90%;
            height: 90%;
        }
    </style>
</head>

<body>
    <div id="cy"></div>
</body>

</html>
